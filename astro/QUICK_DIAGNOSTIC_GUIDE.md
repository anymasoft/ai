# üîç –ë–´–°–¢–†–´–ô –ì–ê–ô–î –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò Error 2013

## üìã –°—Ç–∞—Ç—É—Å –ö–æ–¥–∞ (–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ)

‚úÖ **Callback endpoint:** `/src/pages/minimax_callback.ts` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω
‚úÖ **Export:** `export async function POST(request: Request)` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
‚úÖ **Challenge handling:** JSON response —Å challenge - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
‚úÖ **API payload:** –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (image, prompt, duration, callback_url) - –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
‚úÖ **Duration —Ç–∏–ø:** Number - –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω
‚úÖ **Callback URL:** –ë–µ–∑ /api - –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üéØ –ß–¢–û –î–ï–õ–ê–¢–¨ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LOCAL —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (localhost:3000)

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
cd /home/user/ai/astro
npm run dev

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–∫–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è, –ø–æ—Ç–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
cd /home/user/ai/astro
bash diagnostic_minimax.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ngrok (–¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ MiniMax)

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ ngrok –∑–∞–ø—É—â–µ–Ω
ngrok http 3000
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –∏–∑ –≤—ã–≤–æ–¥–∞: https://xxxx-xxxx.ngrok.io

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –°–æ–∑–¥–∞–π—Ç–µ .env —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π callback URL
cat > /home/user/ai/astro/.env << EOF
MINIMAX_API_KEY=–≤–∞—à_–∫–ª—é—á
MINIMAX_CALLBACK_URL=https://xxxx-xxxx.ngrok.io
DATABASE_URL=vr_ai.db
EOF

# –¢–µ—Ä–º–∏–Ω–∞–ª 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
cd /home/user/ai/astro
npm run dev

# –¢–µ—Ä–º–∏–Ω–∞–ª 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
cd /home/user/ai/astro
bash diagnostic_minimax.sh
```

---

## üß™ –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

### ‚úÖ –í–°–ï –¢–ï–°–¢–´ PASS

```
‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
‚úÖ Challenge verification —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ Content-Type = application/json
```

**–≠–¢–û –ó–ù–ê–ß–ò–¢:**
- –õ–æ–∫–∞–ª—å–Ω–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ ngrok URL –∏–ª–∏ firewall
- **–î–ï–ô–°–¢–í–ò–ï:**
  1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `MINIMAX_CALLBACK_URL` –≤ .env —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ngrok URL
  2. –ï—Å–ª–∏ ngrok –±—ã–ª –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω - –æ–±–Ω–æ–≤–∏—Ç–µ URL –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ npm run dev
  3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall –ø—Ä–∞–≤–∏–ª–∞ (–¥–æ–ª–∂–Ω—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

### ‚ùå –û–®–ò–ë–ö–ê: 404 Not Found

```
HTTP –°—Ç–∞—Ç—É—Å: 404
Response: 404 - Not Found
```

**–≠–¢–û –ó–ù–ê–ß–ò–¢:**
- Endpoint –Ω–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω
- –§–∞–π–ª `/src/pages/minimax_callback.ts` –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–î–ï–ô–°–¢–í–ò–ï:**
  1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `ls /home/user/ai/astro/src/pages/minimax_callback.ts`
  2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä: `npm run dev`
  3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–Ω–æ–≤–∞

### ‚ùå –û–®–ò–ë–ö–ê: 500 Internal Server Error

```
HTTP –°—Ç–∞—Ç—É—Å: 500
Response: Internal Server Error
```

**–≠–¢–û –ó–ù–ê–ß–ò–¢:**
- –ö–æ–¥ –≤ callback endpoint'–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
- –û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ
- **–î–ï–ô–°–¢–í–ò–ï:**
  1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `npm run dev`
  2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `[MINIMAX_CALLBACK]`
  3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –∑–∞ –æ—à–∏–±–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è
  4. –î–∞–π—Ç–µ –º–Ω–µ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏

### ‚ö†Ô∏è –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô Content-Type

```
Response Headers:
Content-Type: text/html
```

**–≠–¢–û –ó–ù–ê–ß–ò–¢:**
- Astro –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTML –≤–º–µ—Å—Ç–æ JSON
- –í–æ–∑–º–æ–∂–Ω–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç –∏–ª–∏ –æ—à–∏–±–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
- **–î–ï–ô–°–¢–í–ò–ï:**
  1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–µ—Ç middleware –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å
  2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ –≤ –∫–æ–¥–µ
  3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

---

## üìä –ü–†–ò–ú–ï–† –£–°–ü–ï–®–ù–û–ì–û –í–´–í–û–î–ê

```
==========================================
–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: MiniMax Callback Integration
==========================================

[1/5] –ü–†–û–í–ï–†–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò
------
BASE_URL: http://localhost:3000
CALLBACK_URL: http://localhost:3000/minimax_callback

[2/5] –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –°–ï–†–í–ï–†–ê
------
‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω

[3/5] –ü–†–û–í–ï–†–ö–ê ENDPOINT'–∞ (HEAD –∑–∞–ø—Ä–æ—Å)
------
HEAD http://localhost:3000/minimax_callback
–°—Ç–∞—Ç—É—Å: 405
‚ÑπÔ∏è  –°—Ç–∞—Ç—É—Å HEAD: 405 (—ç—Ç–æ –û–ö –¥–ª—è HEAD, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–º POST)

[4/5] –ü–†–û–í–ï–†–ö–ê CHALLENGE VERIFICATION (–≥–ª–∞–≤–Ω—ã–π —Ç–µ—Å—Ç)
------
–û—Ç–ø—Ä–∞–≤–ª—è—é challenge-–∑–∞–ø—Ä–æ—Å...
POST http://localhost:3000/minimax_callback
Payload: {"challenge":"test_challenge_12345"}

HTTP –°—Ç–∞—Ç—É—Å: 200
Response: {"challenge":"test_challenge_12345"}
‚úÖ PASS: Challenge verification —Ä–∞–±–æ—Ç–∞–µ—Ç
   Endpoint –≤–µ—Ä–Ω—É–ª challenge –≤ JSON

[5/5] –ü–†–û–í–ï–†–ö–ê HEADERS –ò CONTENT-TYPE
------
Response Headers:
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-cache, no-store, must-revalidate
‚úÖ PASS: Content-Type = application/json

==========================================
–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê
==========================================

–ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø:
- –ï—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã PASS: –ø—Ä–æ–±–ª–µ–º–∞ –≤ ngrok URL –∏–ª–∏ firewall
```

---

## üîß –ï–°–õ–ò –í–°–ï –õ–û–ö–ê–õ–¨–ù–û –†–ê–ë–û–¢–ê–ï–¢ –ù–û MiniMax –û–¢–ö–ê–ó–´–í–ê–ï–¢

–¢–æ–≥–¥–∞ 100% –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

### 1. ngrok URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?
```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ ngrok web UI
open http://localhost:4040

# –¢–∞–º –±—É–¥–µ—Ç –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π URL
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —ç—Ç–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å MINIMAX_CALLBACK_URL –≤ .env
```

### 2. ngrok –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç —Ä–µ—Å—Ç–∞—Ä—Ç?
```bash
# –ï—Å–ª–∏ ngrok –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω, URL –∏–∑–º–µ–Ω—è–µ—Ç—Å—è!
# –ù–æ–≤—ã–π URL: https://NEW-RANDOM-ID.ngrok.io

# –û–±–Ω–æ–≤–∏—Ç–µ .env:
echo "MINIMAX_CALLBACK_URL=https://NEW-RANDOM-ID.ngrok.io" > /home/user/ai/astro/.env

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ npm run dev
```

### 3. Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç?
```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å –≤–Ω–µ—à–Ω–µ–π –º–∞—à–∏–Ω—ã
curl -X POST https://YOUR-NGROK-URL/minimax_callback \
  -H "Content-Type: application/json" \
  -d '{"challenge": "test"}'

# –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ –≤ firewall
```

### 4. Callback URL –≤–∫–ª—é—á–∞–µ—Ç –ª–∏—à–Ω–∏–µ —á–∞—Å—Ç–∏?
```bash
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
MINIMAX_CALLBACK_URL=https://yourdomain.com
MINIMAX_CALLBACK_URL=https://abcd-1234.ngrok.io

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
MINIMAX_CALLBACK_URL=https://yourdomain.com/api
MINIMAX_CALLBACK_URL=https://yourdomain.com:8000
MINIMAX_CALLBACK_URL=https://yourdomain.com/minimax_callback  (–ø—É—Ç—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
```

---

## üìû –ï–°–õ–ò –ù–£–ñ–ù–ê –ü–û–ú–û–©–¨

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ:

1. **OUTPUT –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
   ```bash
   bash diagnostic_minimax.sh 2>&1 | tee diagnostic_output.txt
   # –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ diagnostic_output.txt
   ```

2. **–õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:**
   ```bash
   # –ò–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω npm run dev, –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å [MINIMAX_CALLBACK]
   # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ –ª–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å—Ç—Ä–æ–∫
   ```

3. **–í–∞—à–∞ —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
   ```bash
   # –ë–ï–ó –ß–£–í–°–¢–í–ò–¢–ï–õ–¨–ù–´–• –î–ê–ù–ù–´–•!
   echo "MINIMAX_CALLBACK_URL=$MINIMAX_CALLBACK_URL"
   # (—Ç–æ–ª—å–∫–æ URL, –±–µ–∑ API_KEY)
   ```

---

## üöÄ –ò–¢–û–ì–û

**–°—Ç–∞—Ç—É—Å –∫–æ–¥–∞:** ‚úÖ 100% –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
**–°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:** ‚úÖ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Python
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É

```bash
bash diagnostic_minimax.sh
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∂—É—Ç –¢–û–ß–ù–£–Æ –ø—Ä–∏—á–∏–Ω—É error 2013.
