---
import Container from "./Container.astro";
---

<header>
    <nav class="border-b border-black/5 dark:border-white/5 bg-white dark:bg-gray-950">
        <Container>
            <div class="relative flex flex-wrap items-center justify-between gap-6 py-3 md:gap-0 md:py-4">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <a href="/" aria-label="logo" class="flex items-center space-x-2">
                        <img src="/vr_logo_small.png" alt="Video Reader AI" class="h-8 w-8" />
                        <span class="text-2xl font-bold text-gray-900 dark:text-white">Video Reader AI</span>
                    </a>
                </div>

                <!-- Right side: Credits + Upgrade + User Menu -->
                <div class="flex items-center gap-3">
                    <div class="text-right">
                        <p class="text-sm text-gray-600 dark:text-gray-400">Credits remaining</p>
                        <p class="text-2xl font-bold text-primary">5</p>
                    </div>

                    <a
                        href="/billing"
                        class="relative flex h-9 items-center justify-center px-4 before:absolute before:inset-0 before:rounded-full before:bg-primary before:transition before:duration-300 hover:before:scale-105 active:duration-75 active:before:scale-95"
                    >
                        <span class="relative text-sm font-semibold text-white">Upgrade</span>
                    </a>

                    <!-- User Avatar Menu -->
                    <div class="relative group">
                        <button
                            id="user-menu-trigger"
                            class="flex h-9 w-9 items-center justify-center rounded-full bg-gradient-to-br from-primary to-blue-600 text-white font-semibold text-sm hover:shadow-lg transition-shadow duration-200"
                            title="User menu"
                        >
                            JD
                        </button>

                        <!-- Dropdown Menu -->
                        <div
                            id="user-menu-dropdown"
                            class="hidden absolute right-0 mt-2 w-48 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-lg group-hover:block z-50"
                        >
                            <!-- User Info -->
                            <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                                <p class="font-semibold text-gray-900 dark:text-white">John Doe</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">john@example.com</p>
                            </div>

                            <!-- Menu Items -->
                            <div class="py-2">
                                <a
                                    href="/dashboard/account"
                                    class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition"
                                >
                                    Account Settings
                                </a>
                                <a
                                    href="/dashboard/billing"
                                    class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition"
                                >
                                    Billing
                                </a>
                            </div>

                            <!-- Divider -->
                            <div class="border-t border-gray-200 dark:border-gray-700"></div>

                            <!-- Logout -->
                            <button
                                id="logout-btn"
                                class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition"
                            >
                                Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </Container>
    </nav>
</header>

<script>
    const trigger = document.getElementById('user-menu-trigger');
    const dropdown = document.getElementById('user-menu-dropdown');
    const logoutBtn = document.getElementById('logout-btn');

    if (trigger && dropdown) {
        trigger.addEventListener('click', () => {
            dropdown.classList.toggle('hidden');
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!trigger.contains(e.target) && !dropdown.contains(e.target)) {
                dropdown.classList.add('hidden');
            }
        });
    }

    if (logoutBtn) {
        logoutBtn.addEventListener('click', () => {
            // Logout logic here
            console.log('Logout clicked');
        });
    }
</script>
