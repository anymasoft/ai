generate.py:

import base64
import requests

API_KEY = "sk-api-2DXDu..."

def image_to_data_url(path):
    with open(path, "rb") as f:
        return "data:image/jpeg;base64," + base64.b64encode(f.read()).decode()

payload = {
    "model": "MiniMax-Hailuo-02",
    "first_frame_image": image_to_data_url("girl9.jpg"),
    # "prompt": "A young woman wearing jeans walks toward the camera. [Push in]",
    # "prompt": "A young woman wearing jeans walks confidently toward the camera on a clean studio background. The fabric of the jeans moves naturally as she walks, her hair slightly sways. [Push in,Tracking shot]",
    # "prompt": "A young woman in jeans takes a few quick steps forward, lightly turning her hips and smiling. The camera smoothly follows her movement, showing the fit and shape of the jeans. [Tracking shot,Push in]",
    # "prompt": "A young woman in jeans jogs forward slightly and then stops, posing confidently. The camera zooms in to highlight the texture and fit of the jeans. [Push in,Zoom in]",
    "prompt":
"""
Animate this image into a 6-second realistic video.
The motion should be soft, natural and attractive, suitable for OZON / Wildberries product videos.

Include:
– a gentle forward movement of the woman
– subtle motion of water and hair
– a small camera zoom and slight angle shift to add depth

The result should look like a short clean product advertisement video.

"""
,
    "duration": 6,
    "resolution": "512P",
    "callback_url": "https://bb2ac56309a5.ngrok-free.app/minimax_callback"
}

r = requests.post(
    "https://api.minimax.io/v1/video_generation",
    headers={
        "Authorization": f"Bearer {API_KEY}",
        "Content-Type": "application/json"
    },
    json=payload
)

print(r.text)

======================

server.py:

from fastapi import FastAPI, Request
import requests

API_KEY = "sk-api-2DX..."

app = FastAPI()

@app.post("/minimax_callback")
async def minimax_callback(request: Request):
    data = await request.json()
    print("CALLBACK:", data)

    # MiniMax verification ping
    if "challenge" in data:
        return {"challenge": data["challenge"]}

    if data.get("status") == "success":
        file_id = data["file_id"]

        meta = requests.get(
            "https://api.minimax.io/v1/files/retrieve",
            headers={"Authorization": f"Bearer {API_KEY}"},
            params={"file_id": file_id}
        ).json()

        print("META:", meta)

        if "file" in meta and "download_url" in meta["file"]:
            download_url = meta["file"]["download_url"]
        elif "download_url" in meta:
            download_url = meta["download_url"]
        else:
            print("ERROR: no download_url")
            return {"ok": False}

        video = requests.get(download_url)

        with open(f"{file_id}.mp4", "wb") as f:
            f.write(video.content)

        print("Saved:", f"{file_id}.mp4")

    return {"ok": True}
