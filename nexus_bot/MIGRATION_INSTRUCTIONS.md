# –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ú–ò–ì–†–ê–¶–ò–ò –ë–î –ù–ê –°–ï–†–í–ï–†–ï

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

–≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `db.sqlite3` –≤ `sqlite.db`.
**–°–¢–ê–†–ê–Ø –ë–î –ù–ï –£–î–ê–õ–Ø–ï–¢–°–Ø** - –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ backup.

## üìä –ß–¢–û –ë–£–î–ï–¢ –ü–ï–†–ï–ù–ï–°–ï–ù–û

–ù–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ —Å—Ç–∞—Ä–æ–π –ë–î:
- ‚úÖ 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (ID: 432400514)
  - video_balance: 0
  - free_remaining: 3
  - free_used: 0
- ‚úÖ 1 –ø–ª–∞—Ç—ë–∂ (49000 ‚ÇΩ, 5 –≤–∏–¥–µ–æ, —Å—Ç–∞—Ç—É—Å: pending)
- ‚úÖ 0 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π

## üöÄ –®–ê–ì–ò –ú–ò–ì–†–ê–¶–ò–ò –ù–ê –°–ï–†–í–ï–†–ï

### 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ systemctl –∏–ª–∏ kill)
sudo systemctl stop nexus_bot
# –∏–ª–∏
pkill -f "python.*main.py"
```

### 2. –°–¥–µ–ª–∞—Ç—å backup —Å—Ç–∞—Ä–æ–π –ë–î (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞)
```bash
cd /var/www/beemanalytics
cp db.sqlite3 db.sqlite3.backup_$(date +%Y%m%d_%H%M%S)
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
```bash
cd /var/www/beemanalytics
python3 migrate_db.py
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
–°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏:
```
‚úÖ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û
–ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ:
  üë§ Users:       X
  üí≥ Payments:    X
  üé¨ Generations: X
  üìã Queue:       X
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
```bash
sudo systemctl start nexus_bot
# –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ
```

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
- –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
- –ù–∞–∂–º–∏—Ç–µ /start
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
- –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è:
1. ‚úÖ –°—Ç–∞—Ä–∞—è –ë–î **–ù–ï –£–î–ê–õ–Ø–ï–¢–°–Ø** (`db.sqlite3` –æ—Å—Ç–∞—ë—Ç—Å—è)
2. ‚úÖ –î–∞–Ω–Ω—ã–µ **–ö–û–ü–ò–†–£–Æ–¢–°–Ø**, –∞ –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è
3. ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
4. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î

### –û—Ç–∫–∞—Ç –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º:
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
sudo systemctl stop nexus_bot

# 2. –í db.py –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É 11 –æ–±—Ä–∞—Ç–Ω–æ:
# DB_PATH = os.path.join(os.path.dirname(__file__), "db.sqlite3")

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sudo systemctl start nexus_bot
```

## ‚ùì –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨ –ü–û–°–õ–ï –ú–ò–ì–†–ê–¶–ò–ò

### –í –∞–¥–º–∏–Ω–∫–µ –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç–µ–∂–µ–π
- –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–Ω–æ–≤—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ sqlite.db)

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª sqlite.db —Å–æ–∑–¥–∞–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ sqlite.db –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ:
```bash
python3 -c "
import sqlite3
conn = sqlite3.connect('sqlite.db')
c = conn.cursor()
c.execute('SELECT COUNT(*) FROM users')
print(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {c.fetchone()[0]}')
c.execute('SELECT COUNT(*) FROM payments')
print(f'–ü–ª–∞—Ç–µ–∂–µ–π: {c.fetchone()[0]}')
conn.close()
"
```

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ù–ï –£–î–ê–õ–Ø–ô–¢–ï db.sqlite3
2. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏
3. –û—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –∫ —Å—Ç–∞—Ä–æ–π –ë–î (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—ã—à–µ)
4. –°–æ–æ–±—â–∏—Ç–µ –æ –ø—Ä–æ–±–ª–µ–º–µ

## ‚úÖ –§–ê–ô–õ–´

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:
- `db.sqlite3` - —Å—Ç–∞—Ä–∞—è –ë–î (backup, –ù–ï —É–¥–∞–ª—è—Ç—å!)
- `sqlite.db` - –Ω–æ–≤–∞—è –ë–î (—Ä–∞–±–æ—á–∞—è)
- `migrate_db.py` - —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- `MIGRATION_INSTRUCTIONS.md` - —ç—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
